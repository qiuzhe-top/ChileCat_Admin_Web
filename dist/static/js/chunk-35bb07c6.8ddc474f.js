(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-35bb07c6"],{"1ed8":function(e,t){e.exports=function(e,t,i,n){var a="undefined"!==typeof n?[n,e]:[e],o=new Blob(a,{type:i||"application/octet-stream"});if("undefined"!==typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(o,t);else{var s=window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(o):window.webkitURL.createObjectURL(o),l=document.createElement("a");l.style.display="none",l.href=s,l.setAttribute("download",t),"undefined"===typeof l.download&&l.setAttribute("target","_blank"),document.body.appendChild(l),l.click(),setTimeout((function(){document.body.removeChild(l),window.URL.revokeObjectURL(s)}),200)}}},"63eb":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"excel_updata"},[i("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,width:"60%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:e.url,"on-success":e.on_success,"on-error":e.on_error,"on-progress":e.on_progress,"on-change":e.onChangeFile,"on-remove":e.onRemoveFile,headers:{token:e.token()},accept:".xlsx","file-list":e.fileList,"auto-upload":!1,data:e.file_up_data}},[i("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),i("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:e.submitUpload}},[e._v("上传到服务器")]),i("div",{staticClass:"is_down_excel"},[i("el-checkbox",{model:{value:e.is_down_excel,callback:function(t){e.is_down_excel=t},expression:"is_down_excel"}},[e._v("上传结果使用表格导出")])],1),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 请使用提供的模板上传。数据导入不会重复导入 ")])],1),i("el-table",{directives:[{name:"show",rawName:"v-show",value:!e.is_down_excel,expression:"!is_down_excel"}],staticStyle:{width:"100%"},attrs:{data:e.up_error_list,"max-height":"350"}},[i("el-table-column",{attrs:{prop:"username",label:"学号",width:"180"}}),i("el-table-column",{attrs:{prop:"name",label:"姓名",width:"180"}}),i("el-table-column",{attrs:{prop:"message",label:"信息"}}),i("el-table-column",{attrs:{prop:"str_time",label:"记录日期"}})],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")])],1)],1),i("el-button",{attrs:{width:"120"},on:{click:function(t){e.dialogVisible=!0}}},[e._t("default")],2)],1)},a=[],o=(i("304d"),i("f257"),i("89a8"),i("2478"),i("b110"),i("fe35"),i("8fec"),i("9135"));function s(e,t){var i="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=Object(o["a"])(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,l=!0,r=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return l=e.done,e},e:function(e){r=!0,s=e},f:function(){try{l||null==i["return"]||i["return"]()}finally{if(r)throw s}}}}i("10dd"),i("1a91");var l=i("b705"),r=i("5f87"),c=i("1ed8"),u=i.n(c),d={props:{url:{type:String,default:""},title:{type:String,default:""},is_down_excel:{type:Boolean,default:!1}},data:function(){return{in_zaoqian_MORNING_SIGN_excel_url:this.$api.school_attendance.in_zaoqian_MORNING_SIGN_excel_url,fileList:[],file_up_data:{tok:123},up_error_list:[],dialogVisible:!1,loading_flg:!0,data_str:"206510101 2021/10/15\r206510101\t2021/10/15",upFile:[],upFileList:[],showUpFile:!0,fullscreenLoading:!1}},created:function(){},methods:{onChangeFile:function(e,t){var i=e.size/1024/1024<25;if(!i)return this.$msgbox.alert("上传文件大小不能超过 25MB!"),!1;this.upFileList=[];var n,a=s(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;o.raw&&this.upFileList.push(o.raw)}}catch(l){a.e(l)}finally{a.f()}console.log(this.upFileList)},beforeRemove:function(e,t){return this.$msgbox.alert("确定移除 ".concat(e.name,"？"))},onRemoveFile:function(e,t){this.upFileList=[];var i,n=s(t);try{for(n.s();!(i=n.n()).done;){var a=i.value;a.raw&&this.upFileList.push(a.raw)}}catch(o){n.e(o)}finally{n.f()}},submitUpload:function(){var e=this;if(0!==this.upFileList.length)if(this.is_down_excel){!1===this.fullscreenLoading&&(this.fullscreenLoading=!0);var t=this.upFileList.shift();this.$api.school_attendance.batch_attendance(t,this.$props.url).then((function(t){console.log(t),u()(t,"考勤记录.xls"),e.upFileList.length>=1?e.submitUpload():(e.closeLoading(),e.$refs.upload.clearFiles(),e.fullscreenLoading=!1)})).catch((function(t){e.$message.error("上传失败")}))}else this.$refs.upload.submit();else this.$message({message:"暂时没有需要上传的文件",type:"success"})},download:function(){console.log(this.upFileList,this.fileList)},on_success:function(e,t,i){var n=this;this.$data.up_error_list=[],e.data.forEach((function(e){var t={};t["username"]=e[0],t["name"]=e[1],t["message"]=e[2],t["str_time"]=e[3],n.$data.up_error_list.push(t)})),this.closeLoading(),this.$refs.upload.clearFiles(),this.$message({message:e.message,type:"success"})},handleClose:function(e){this.$confirm("确认关闭？").then((function(t){e()})).catch((function(e){}))},on_progress:function(e,t,i){console.log(e,t,i),this.$loading()},on_error:function(){this.closeLoading(),this.$message({message:"上传失败",type:"warning"})},token:function(){return Object(r["a"])()},closeLoading:function(){var e=l["Loading"].service();this.$nextTick((function(){e.close()}))}}},f=d,p=(i("a247"),i("cba8")),h=Object(p["a"])(f,n,a,!1,null,null,null);t["a"]=h.exports},"8b25":function(e,t,i){},9406:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"dashboard-container"},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{lg:8,xl:1}},[i("el-card",{staticClass:"box-card"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[e._v("系统信息")])]),i("div",{staticClass:"dashboard-text"},[e._v("您好， "+e._s(e.name)+" ")])])],1),i("el-col",{attrs:{lg:9,xl:11}})],1)],1)},a=[],o=i("597f"),s=i("52c1"),l=i("63eb"),r={name:"Dashboard",components:{ExcelUpdata:l["a"]},computed:Object(o["a"])({},Object(s["b"])(["name"]))},c=r,u=(i("c17a"),i("cba8")),d=Object(u["a"])(c,n,a,!1,null,"42044207",null);t["default"]=d.exports},a247:function(e,t,i){"use strict";i("8b25")},c17a:function(e,t,i){"use strict";i("d852")},d852:function(e,t,i){}}]);