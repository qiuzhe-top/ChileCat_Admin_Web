(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a3032262"],{"0d25":function(t,e,s){"use strict";s("61d8")},4510:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app"},[s("el-row",{attrs:{gutter:10}},[s("el-col",[s("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",[t._v(" "+t._s(t.actives[t.active_index].name)+" ")]),s("div",{staticStyle:{display:"inline"},on:{click:function(e){return t.task_switch_put()}}},[s("el-switch",{staticStyle:{float:"right",padding:"3px 0"},attrs:{disabled:t.is_switch,"active-text":"开启","inactive-text":"关闭"},model:{value:t.actives[t.active_index].is_open,callback:function(e){t.$set(t.actives[t.active_index],"is_open",e)},expression:"actives[active_index].is_open"}})],1)]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.actives[t.active_index].is_open,expression:"actives[active_index].is_open"}],staticClass:"text item"},[s("el-button",{on:{click:function(e){t.dialogVisible_roster_box=!0}}},[t._v("排班 ")]),s("el-button",{on:{click:function(e){return t.flush()}}},[t._v(" 重置任务")]),s("el-button",{on:{click:function(e){return t.get_condition()}}},[t._v("刷新记录")])],1)])],1)],1),s("br"),s("el-dialog",{staticClass:"dialog_roster",attrs:{title:"排班",visible:t.dialogVisible_roster_box,width:"90%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible_roster_box=e}}},[s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{xs:24,md:24}},[s("h3",[t._v("添加")]),s("div",{staticClass:"input_box"},[s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{xs:24,md:9}},[s("el-input",{attrs:{size:"small",placeholder:"学号"},model:{value:t.input_user_object.username,callback:function(e){t.$set(t.input_user_object,"username",e)},expression:"input_user_object.username"}})],1),s("el-col",{attrs:{xs:24,md:9}},[s("el-input",{attrs:{size:"small",placeholder:"姓名"},model:{value:t.input_user_object.name,callback:function(e){t.$set(t.input_user_object,"name",e)},expression:"input_user_object.name"}})],1),s("el-col",{attrs:{xs:24,md:6}},[s("el-button",{attrs:{size:"small",icon:"el-icon-search"},on:{click:function(e){return t.search_user()}}},[t._v("搜索")]),s("el-button",{attrs:{size:"small",icon:"el-icon-circle-plus-outline"},on:{click:function(e){return t.add_user()}}},[t._v("添加")])],1)],1)],1)]),s("br"),s("el-col",{attrs:{xs:24,md:8}},[s("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入多个学号"},model:{value:t.user_list_str,callback:function(e){t.user_list_str=e},expression:"user_list_str"}})],1),s("el-col",{attrs:{xs:24,md:4}},[s("el-button",{on:{click:function(e){return t.add_user_list_str()}}},[t._v("添加")])],1),s("el-col",{attrs:{xs:24,md:12}},[s("h3",[t._v("名单")]),t._l(t.roster,(function(e,i){return s("div",{key:i},[t._v(" "+t._s(e.username)+" "+t._s(e.name)+" "),s("el-button",{attrs:{size:"mini",icon:"el-icon-close"},on:{click:function(e){return t.remove_user(i)}}})],1)}))],2)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dialogVisible_roster_box=!1}}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.save_roster()}}},[t._v("保存")])],1)],1),s("br"),s("el-row",[s("el-col",{attrs:{sm:24}},[s("el-card",{directives:[{name:"show",rawName:"v-show",value:t.actives[t.active_index].is_open,expression:"actives[active_index].is_open"}],attrs:{shadow:"hover"}},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",[t._v("晚自修检查记录")])]),s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[s("el-table-column",{attrs:{prop:"student_approved_number",label:"学号",width:"180"}}),s("el-table-column",{attrs:{prop:"student_approved",label:"姓名",width:"180"}}),s("el-table-column",{attrs:{prop:"rule_str",label:"原因"}}),s("el-table-column",{attrs:{prop:"worker",label:"执行人"}}),s("el-table-column",{attrs:{prop:"star_time",label:"执行时间"}}),s("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{width:"120",type:e.row.flg?"warning":"info"},on:{click:function(s){return t.pintle(1,e.row)}}},[t._v(" 销假")])]}}])})],1)],1)],1)],1)],1)},a=[],n=(s("e35a"),s("0d7a"),s("08ba"),s("ea69"),{data:function(){return{is_switch:!1,excel_url:"",switc:"",actives:[{id:"",name:"加载中",is_open:!1,is_builder:!1}],active_index:0,code:"*****",tableData:[],input_list:[],user_list:[],dialogTableVisible:!0,flg:!0,formLabelWidth:"120px",username:"",roster:[{username:"",name:""}],dialogVisible_roster_box:!1,user_list_str:"",input_user_object:{}}},created:function(){this.get_activa(),this.get_condition()},methods:{get_activa:function(){var t=this;this.$store.dispatch("SchoolAttendance/my_active",{type:"2"}).then((function(e){var s=e.data;t.actives=s,t.get_scheduling()})).catch((function(){}))},task_switch_put:function(){var t=this;console.log("切换");var e=this.$data.actives[this.active_index].id;this.is_switch=!0,this.$store.dispatch("SchoolAttendance/task_switch_put",{id:e}).then((function(e){t.$data.switc=e.data,t.is_switch=!1})).catch((function(e){console.log(e),t.is_switch=!1}))},flush:function(){var t=this;this.$confirm("此操作将重置当天房间被查记录、重置所有学生在寝状态为在 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e=t.actives[t.active_index].id;t.$api.SchoolAttendance.task_switch_delete({task_id:e}).then((function(e){t.$message({message:e.message,type:"success"})}))})).catch((function(){t.$message({type:"info",message:"已取消"})}))},get_scheduling:function(){var t=this;this.$api.SchoolAttendance.scheduling_get({id:this.actives[this.active_index]["id"]}).then((function(e){t.roster=e.data})).catch((function(){}))},add_user:function(){""!=this.$data.input_user_object.username&&(this.$data.roster.push(this.$data.input_user_object),this.$data.input_user_object={username:"",name:""})},add_user_list_str:function(){var t=this,e=this.$data.user_list_str;if(!(e.length<1)){var s=e.split("\n");s.forEach((function(e){t.$api.SchoolAttendance.searchUser({username:e}).then((function(e){t.$data.roster.push(e.data)})).catch((function(t){console.log(t)}))})),console.log(s)}},remove_user:function(t){this.$data.roster.splice(t,1)},search_user:function(){var t=this;this.$api.SchoolAttendance.searchUser({username:this.$data.input_user_object.username}).then((function(e){t.$data.input_user_object=e.data,console.log(e.data)})).catch((function(t){console.log(t)})),clearTimeout(this.timeout),this.timeout=setTimeout((function(){}),2e3*Math.random())},save_roster:function(){var t=this;console.log(" 保存班表",this.roster);var e=this.actives[this.active_index].id;this.$api.SchoolAttendance.scheduling_post({roster:this.roster,id:e,data:""}).then((function(e){console.log(e),2e3===e.code&&(t.$message({message:e.message,type:"success"}),t.$data.dialogVisible_roster_box=!1)}))},get_condition:function(){var t=this;this.$data.actives[this.active_index].id&&this.$store.dispatch("SchoolAttendance/condition",{task_id:this.$data.actives[this.active_index].id}).then((function(e){e.data.forEach((function(t,e){t["flg"]=!0})),t.$data.tableData=e.data,console.log("获取缺勤名单"+e.data)})).catch((function(){}))},pintle:function(t,e){var s=this;this.$confirm("此操作将对该同学销假,并且记录您的信息 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){console.log("销假"),s.$api.SchoolAttendance.undo_record_delete({record_id:e.id,task_id:s.$data.actives[s.active_index].id}).then((function(t){2e3===t.code&&(s.$message({message:t.message,type:"success"}),e.flg=!1)})).catch((function(t){s.$message({type:"info",message:"失败"})}))})).catch((function(){s.$message({type:"info",message:"已取消"})}))},exportexcel:function(){var t=this;api.exportexcel().then((function(e){t.$message({message:e.message,type:"success"})}))},handleClose:function(t){this.$confirm("确认关闭？").then((function(e){t()})).catch((function(t){}))}}}),o=n,c=(s("0d25"),s("4ac2")),r=Object(c["a"])(o,i,a,!1,null,"ded45fa4",null);e["default"]=r.exports},"61d8":function(t,e,s){},ea69:function(t,e,s){"use strict";var i=s("1c8b"),a=s("e1d6"),n=s("3da3"),o=s("d88d"),c=s("3553"),r=s("1ca1"),l=s("1bbd"),u=s("1ea7"),d=s("ff9c"),_=u("splice"),h=d("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,f=Math.min,v=9007199254740991,m="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!_||!h},{splice:function(t,e){var s,i,u,d,_,h,b=c(this),g=o(b.length),x=a(t,g),w=arguments.length;if(0===w?s=i=0:1===w?(s=0,i=g-x):(s=w-2,i=f(p(n(e),0),g-x)),g+s-i>v)throw TypeError(m);for(u=r(b,i),d=0;d<i;d++)_=x+d,_ in b&&l(u,d,b[_]);if(u.length=i,s<i){for(d=x;d<g-i;d++)_=d+i,h=d+s,_ in b?b[h]=b[_]:delete b[h];for(d=g;d>g-i+s;d--)delete b[d-1]}else if(s>i)for(d=g-i;d>x;d--)_=d+i-1,h=d+s-1,_ in b?b[h]=b[_]:delete b[h];for(d=0;d<s;d++)b[d+x]=arguments[d+2];return b.length=g-i+s,u}})}}]);